import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{ah as a,aj as n,ai as r}from"./app-B6sY9bXt.js";const s={};function o(i,e){return r(),a("div",null,e[0]||(e[0]=[n(`<p><a href="https://bbs.hassbian.com/thread-18611-1-1.html" target="_blank" rel="noopener noreferrer">【node-red】深圳儿童疫苗接种信息接入</a></p><blockquote><h2 id="概要" tabindex="-1"><a class="header-anchor" href="#概要"><span>概要</span></a></h2><p>11.24更新：修改了oauth的请求头function，现在接种记录的时效比较长了，稳定性还在确认当中UI展示写在前面这个插件主要方便宝宝在深圳地区出生的家长（比如我）随 ... 【node-red】深圳儿童疫苗接种信息接入 ,『瀚思彼岸』» 智能家居技术论坛</p></blockquote><hr><p><em>本帖最后由 arthurfsy 于 2022-11-24 10:52 编辑</em> 11.24更新：修改了oauth的请求头function，现在接种记录的时效比较长了，稳定性还在确认当中</p><p>UI展示<br><img src="https://attachment.hasstatic.com/forum/202211/14/161835lwcy85rryro8r9cy.jpg" alt="" width="400" loading="lazy"></p><div class="hint-container tip"><p class="hint-container-title">写在前面</p><p>这个插件主要方便<strong>宝宝在深圳地区出生</strong>的家长（比如我）随时查看已经接种的疫苗信息、待接种疫苗计划等信息，<strong>在了解总花费的同时，不错过娃的疫苗接种。</strong></p><p>PS：小程序前端展示信息较少，并无金额、厂商等信息，但是后台是有以上数据的，本NR流进行了<strong>数据采集、整理、展示</strong></p></div><p><strong>目前问题</strong>：查询接种记录容易失效，查询接种计划的token目前发现能坚持比较长时间</p><p>解决方法：如果遇到token失效导致NR无法获取数据，用你抓包的账号重新登录小程序，然后再跑一遍NR</p><h2 id="已实现的功能" tabindex="-1"><a class="header-anchor" href="#已实现的功能"><span>已实现的功能</span></a></h2><p>1、<strong>汇总</strong>所有自费金额</p><p>2、获取<strong>已接种</strong>疫苗信息（是否免费/自费金额、疫苗名称、厂商、剂次、接种时间、接种地点等）</p><p>3、获取<strong>待接种</strong>疫苗信息</p><h2 id="nr流使用主要流程" tabindex="-1"><a class="header-anchor" href="#nr流使用主要流程"><span>NR流使用主要流程</span></a></h2><h3 id="_1-在hass安装node-red集成" tabindex="-1"><a class="header-anchor" href="#_1-在hass安装node-red集成"><span>1.在HASS安装Node-red集成</span></a></h3><h3 id="_2-手机微信打开-深圳疾控-公众号——打疫苗——普通疫苗-儿童预约-——接种计划-接种记录-如果绑定了多个账号-则需要切换" tabindex="-1"><a class="header-anchor" href="#_2-手机微信打开-深圳疾控-公众号——打疫苗——普通疫苗-儿童预约-——接种计划-接种记录-如果绑定了多个账号-则需要切换"><span>2.手机微信打开“深圳疾控”公众号——打疫苗——普通疫苗（儿童预约）——接种计划/接种记录（如果绑定了多个账号，则需要切换）</span></a></h3><figure><img src="https://attachment.hasstatic.com/forum/202211/14/161834ggml6vk6meajs6kg.jpg" alt="" width="400" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>3.IOS通过Stream抓包/WIN通过Charles抓PC微信小程序（对应NR的var变量），每个链接的变量对应的数值要改成你自己的</p><figure><img src="https://attachment.hasstatic.com/forum/202211/14/162126khbiktiugcbbi4kb.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p><strong>接种记录：<strong>需要抓以下</strong>2</strong>个请求：</p><blockquote><ul><li><a href="https://imm.szcdc.net/miWeixin/**oauth/**login?code=XXXXX" target="_blank" rel="noopener noreferrer">https://imm.szcdc.net/miWeixin/**oauth/**login?code=XXXXX</a>  //这里的token不同的账号、每次登陆都有变化，需要抓取（动态更新的，如果失效了要重新抓）</li><li><a href="https://imm.szcdc.net/miWeixin/wx/selfRegister/**getWxSelfFiftyoneById**?userInfoId=XXXXX&amp;persNo=XXXXX" target="_blank" rel="noopener noreferrer">https://imm.szcdc.net/miWeixin/wx/selfRegister/**getWxSelfFiftyoneById**?userInfoId=XXXXX&amp;persNo=XXXXX</a>   //这里的userInfoId、persNo<strong>和上面一样</strong>，需要抓取（固定的，只需要抓一次）</li></ul></blockquote><p><strong>接种记录：<strong>需要抓以下</strong>1</strong>个请求：</p><blockquote><ul><li><a href="https://imm.szcdc.net/mobileSz/oneTwo/getNinePlan" target="_blank" rel="noopener noreferrer">https://imm.szcdc.net/mobileSz/oneTwo/getNinePlan</a>  //这里的token和<strong>接种记录</strong>的不一样，所以需要抓取（动态更新的，如果失效了要重新抓）</li></ul></blockquote><h3 id="_3-将抓到的headers、payload数据填入nr流的-手工-修改x个参数-、-手工-修改请求头-的function函数中-注意每个请求对应的数据不完全一样-点击运行-homeassistant需要改为自己系统的-输入完后点击部署" tabindex="-1"><a class="header-anchor" href="#_3-将抓到的headers、payload数据填入nr流的-手工-修改x个参数-、-手工-修改请求头-的function函数中-注意每个请求对应的数据不完全一样-点击运行-homeassistant需要改为自己系统的-输入完后点击部署"><span>3.将抓到的headers、payload数据填入NR流的**“手工：修改X个参数”、**“手工：修改请求头”的function函数中（注意每个请求对应的数据不完全一样），点击运行(HOMEASSISTANT需要改为自己系统的)，输入完后点击部署</span></a></h3><h3 id="_4-实体名称说明" tabindex="-1"><a class="header-anchor" href="#_4-实体名称说明"><span>4.实体名称说明</span></a></h3><blockquote><p>最近疫苗：VaccineRec<br> 计划疫苗：planVaccine</p></blockquote><h3 id="_5-前端卡片是markdown-实体的数据已经包含颜色显示的代码-配合markdown显示更加友好。" tabindex="-1"><a class="header-anchor" href="#_5-前端卡片是markdown-实体的数据已经包含颜色显示的代码-配合markdown显示更加友好。"><span>5.前端卡片是markdown，实体的数据已经包含颜色显示的代码，配合markdown显示更加友好。</span></a></h3><div class="language-markdown line-numbers-mode" data-highlighter="shiki" data-ext="markdown" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">---</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">已接种疫苗--[目前总自费：&lt;font color=&quot;#00dddd&quot;&gt;{{ states(&#39;sensor.vaccine_total_cost&#39;)}}元&lt;/font&gt;]：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{{ state_attr(&#39;sensor.vaccinerec&#39;,&#39;vaccinerec&#39;)}} </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#E06C75;">---</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">待接种疫苗</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{{ state_attr(&#39;sensor.planvaccine&#39;,&#39;planvaccine&#39;)}}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://www.hasstatic.com/image/filetype/zip.gif" alt="" loading="lazy"> <a href="https://bbs.hassbian.com/forum.php?mod=attachment&amp;aid=NDMyNzR8ODAwNmEzYjB8MTY5NDcwMjI3OXw1NzI4M3wxODYxMQ%3D%3D" target="_blank" rel="noopener noreferrer">深圳疫苗记录查询.zip</a> <em>(3.54 KB, 下载次数: 6)</em></p>`,28)]))}const d=t(s,[["render",o]]),l=JSON.parse(`{"path":"/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/Node-red/%E3%80%90node-red%E3%80%91%E6%B7%B1%E5%9C%B3%E5%84%BF%E7%AB%A5%E7%96%AB%E8%8B%97%E6%8E%A5%E7%A7%8D%E4%BF%A1%E6%81%AF%E6%8E%A5%E5%85%A5.html","title":"【node-red】深圳儿童疫苗接种信息接入","lang":"zh-CN","frontmatter":{"title":"【node-red】深圳儿童疫苗接种信息接入","icon":"brands:node","category":["经验总结"],"tag":["IT总结","Node-Red"],"date":"2022-11-14T00:00:00.000Z","order":2,"description":"【node-red】深圳儿童疫苗接种信息接入 概要 11.24更新：修改了oauth的请求头function，现在接种记录的时效比较长了，稳定性还在确认当中UI展示写在前面这个插件主要方便宝宝在深圳地区出生的家长（比如我）随 ... 【node-red】深圳儿童疫苗接种信息接入 ,『瀚思彼岸』» 智能家居技术论坛 本帖最后由 arthurfsy 于 2...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【node-red】深圳儿童疫苗接种信息接入\\",\\"image\\":[\\"https://attachment.hasstatic.com/forum/202211/14/161835lwcy85rryro8r9cy.jpg =400x\\",\\"https://attachment.hasstatic.com/forum/202211/14/161834ggml6vk6meajs6kg.jpg =400x\\",\\"https://attachment.hasstatic.com/forum/202211/14/162126khbiktiugcbbi4kb.png\\",\\"https://www.hasstatic.com/image/filetype/zip.gif\\"],\\"datePublished\\":\\"2022-11-14T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-26T06:29:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Arthur\\",\\"url\\":\\"https://blog.4a1801.life\\"}]}"],["meta",{"property":"og:url","content":"https://blog.4a1801.life/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/Node-red/%E3%80%90node-red%E3%80%91%E6%B7%B1%E5%9C%B3%E5%84%BF%E7%AB%A5%E7%96%AB%E8%8B%97%E6%8E%A5%E7%A7%8D%E4%BF%A1%E6%81%AF%E6%8E%A5%E5%85%A5.html"}],["meta",{"property":"og:site_name","content":"Family's Life"}],["meta",{"property":"og:title","content":"【node-red】深圳儿童疫苗接种信息接入"}],["meta",{"property":"og:description","content":"【node-red】深圳儿童疫苗接种信息接入 概要 11.24更新：修改了oauth的请求头function，现在接种记录的时效比较长了，稳定性还在确认当中UI展示写在前面这个插件主要方便宝宝在深圳地区出生的家长（比如我）随 ... 【node-red】深圳儿童疫苗接种信息接入 ,『瀚思彼岸』» 智能家居技术论坛 本帖最后由 arthurfsy 于 2..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://attachment.hasstatic.com/forum/202211/14/161835lwcy85rryro8r9cy.jpg =400x"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-26T06:29:33.000Z"}],["meta",{"property":"article:tag","content":"Node-Red"}],["meta",{"property":"article:tag","content":"IT总结"}],["meta",{"property":"article:published_time","content":"2022-11-14T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-26T06:29:33.000Z"}]]},"git":{"createdTime":1694703271000,"updatedTime":1737872973000,"contributors":[{"name":"arthurfsy2","username":"arthurfsy2","email":"fsyflh@gmail.com","commits":7,"url":"https://github.com/arthurfsy2"}]},"readingTime":{"minutes":2.94,"words":881},"filePathRelative":"经验总结/IT总结/Node-red/【node-red】深圳儿童疫苗接种信息接入.md","localizedDate":"2022年11月14日","excerpt":"<p><a href=\\"https://bbs.hassbian.com/thread-18611-1-1.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">【node-red】深圳儿童疫苗接种信息接入</a></p>\\n<blockquote>\\n<h2>概要</h2>\\n<p>11.24更新：修改了oauth的请求头function，现在接种记录的时效比较长了，稳定性还在确认当中UI展示写在前面这个插件主要方便宝宝在深圳地区出生的家长（比如我）随 ... 【node-red】深圳儿童疫苗接种信息接入 ,『瀚思彼岸』» 智能家居技术论坛</p>\\n</blockquote>","autoDesc":true}`);export{d as comp,l as data};
