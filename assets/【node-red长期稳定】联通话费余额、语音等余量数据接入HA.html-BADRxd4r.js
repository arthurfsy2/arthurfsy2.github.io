import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{ah as a,aj as s,ai as t}from"./app-lB_HTyG7.js";const i={};function r(o,n){return t(),a("div",null,n[0]||(n[0]=[s(`<p><a href="https://bbs.hassbian.com/thread-20040-1-1.html" target="_blank" rel="noopener noreferrer">【node-red长期稳定】联通话费余额、语音等余量数据接入HA </a></p><blockquote><h2 id="概要" tabindex="-1"><a class="header-anchor" href="#概要"><span>概要</span></a></h2><p>此前我自己也有通过NR抓包过联通余量数据，但是发现token过期很快，然后也看到了下面的帖子，实现方式和我NR的方式差不多。补充：联通话费余额、语音、流量和积分数据接入 ... 【node-red长期稳定】联通话费余额、语音等余量数据接入HA ,『瀚思彼岸』» 智能家居技术论坛</p></blockquote><hr><p><em>本帖最后由 arthurfsy 于 2023-4-24 16:21 编辑</em></p><div class="hint-container tip"><p class="hint-container-title">前言</p><p>此前我自己也有通过NR抓包过联通余量数据，但是发现token过期很快，然后也看到了下面的帖子，实现方式和我NR的方式差不多。<br><a href="https://bbs.hassbian.com/thread-18940-1-1.html" target="_blank" rel="noopener noreferrer">补充：联通话费余额、语音、流量和积分数据接入HomeAssistant (hassbian.com)</a><br> 后来通过查询，找到联通可以通过token_online+appId的方式，动态获取a_token数据，那么这个NR就是解决了token_online保存的问题（其实不保存问题也不大，token_online实测时效很久）</p><p><strong>Tips：本flow的默认更新间隔为5分钟，如果出现无法获取数据的情况，可以把间隔时间改为10-20分钟</strong></p></div><figure><img src="https://attachment.hasstatic.com/forum/202303/14/143425pkn9ub5rnr6ruhn5.jpg" alt="img" width="400" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="本flow功能" tabindex="-1"><a class="header-anchor" href="#本flow功能"><span>本flow功能：</span></a></h2><h3 id="_1-可定时查询联通余量-话费、语音、流量、积分数据4个实体可配合卡片展示-。" tabindex="-1"><a class="header-anchor" href="#_1-可定时查询联通余量-话费、语音、流量、积分数据4个实体可配合卡片展示-。"><span>1.可定时查询联通余量（话费、语音、流量、积分数据4个实体可配合卡片展示）。</span></a></h3><h3 id="_2-可查看目前已保存的token-online数据-相当于导出-以备其他使用需求" tabindex="-1"><a class="header-anchor" href="#_2-可查看目前已保存的token-online数据-相当于导出-以备其他使用需求"><span>2.可查看目前已保存的token_online数据（相当于导出，以备其他使用需求）</span></a></h3><h3 id="_3-可清空token-online数据-如果发现数据不对-可先清空再重新运行" tabindex="-1"><a class="header-anchor" href="#_3-可清空token-online数据-如果发现数据不对-可先清空再重新运行"><span>3.可清空token_online数据（如果发现数据不对，可先清空再重新运行）</span></a></h3><h2 id="使用方法" tabindex="-1"><a class="header-anchor" href="#使用方法"><span>使用方法：</span></a></h2><h3 id="_1-对联通app进行抓包-通过1ts获取" tabindex="-1"><a class="header-anchor" href="#_1-对联通app进行抓包-通过1ts获取"><span>1.对联通APP进行抓包/通过1TS获取</span></a></h3><p>该步骤可选，或者下载ITS这个软件进行抓包获取token_online+appId<br> 我是在这个网页下面找到对应的APP下载链接：<a href="https://www.xgiu.com/llljk_1st" target="_blank" rel="noopener noreferrer">联通流量实时监控软件1TS流量监控免费版下载</a></p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>下载地址:</span></span>
<span class="line"><span>https://wwt.lanzoul.com/iDpXD0ecgkfi</span></span>
<span class="line"><span>密码:xgiu</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注：下载1TS APP软件后，需要先通过短信成功登陆一次，然后点击首页的“联通”——左上角“小水滴形状”——右上角“窗口”切换登陆方式。即可看到“token_online”、“appid”数据（小坑：token_online的字符很长，可能复制起来比较折腾）<br><img src="https://attachment.hasstatic.com/forum/202303/14/143251g3k35d37k3e5qkqd.png" alt="img" width="400" loading="lazy"><br><img src="https://attachment.hasstatic.com/forum/202303/14/143251wdjizqwr41iqb33u.jpg" alt="img" width="400" loading="lazy"></p><h3 id="_2-修改nr流里的-设置原始tokenonline-节点-将复制的-token-online-、-appid-粘贴到对应位置" tabindex="-1"><a class="header-anchor" href="#_2-修改nr流里的-设置原始tokenonline-节点-将复制的-token-online-、-appid-粘贴到对应位置"><span>2.修改NR流里的“设置原始tokenOnline”节点，将复制的“token_online”、“appid”粘贴到对应位置</span></a></h3><figure><img src="https://attachment.hasstatic.com/forum/202304/06/173428d10gk00d1kzag6sz.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h3 id="_3-修改file节点里的path目录-如我的是-data-token-online-txt-文件名可自行取值" tabindex="-1"><a class="header-anchor" href="#_3-修改file节点里的path目录-如我的是-data-token-online-txt-文件名可自行取值"><span>3.修改file节点里的path目录，如我的是/data/token_online.txt（文件名可自行取值）</span></a></h3><p><img src="https://attachment.hasstatic.com/forum/202303/14/143622ccgt744y4ctd9u27.png" alt="" loading="lazy"><br> 特别注意：如果NR是docker容器部署的，需要填写对应容器内部的目录<br> 如：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>主机/存储卷目录（实际文件存放目录）：/www/server/docker/volumes/node_red_data/_data</span></span>
<span class="line"><span>挂载路径（容器内部路径）：/data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>如果NR是虚拟机加载项部署的，需要填写以下内容（#34提供的方法，已置顶）：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>/config/node-red/data/token_online.txt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>那么file节点的路径需要填写为/data/token_online.txt，实际存储路径为/www/server/docker/volumes/node_red_data/_data/token_online.txt</p><h3 id="_4-全部设置好后-先运行-联通a-token取值-然后运行-联通取值-稳定取值-即可生成实体" tabindex="-1"><a class="header-anchor" href="#_4-全部设置好后-先运行-联通a-token取值-然后运行-联通取值-稳定取值-即可生成实体"><span>4.全部设置好后，先运行“联通a_token取值”，然后运行“联通取值--稳定取值”，即可生成实体</span></a></h3><h2 id="卡片代码分享" tabindex="-1"><a class="header-anchor" href="#卡片代码分享"><span>卡片代码分享：</span></a></h2><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>type: vertical-stack</span></span>
<span class="line"><span>cards:</span></span>
<span class="line"><span>  - type: custom:mushroom-title-card</span></span>
<span class="line"><span>    title: 更新时间： {{states(&#39;sensor.lian_tong_tao_can_geng_xin_shi_jian&#39;)}}</span></span>
<span class="line"><span>  - type: horizontal-stack</span></span>
<span class="line"><span>    cards:</span></span>
<span class="line"><span>      - type: custom:mushroom-entity-card</span></span>
<span class="line"><span>        entity: sensor.lian_tong_sheng_yu_hua_fei</span></span>
<span class="line"><span>        name: 剩余话费</span></span>
<span class="line"><span>        layout: vertical</span></span>
<span class="line"><span>        icon: mdi:currency-cny</span></span>
<span class="line"><span>        icon_color: green</span></span>
<span class="line"><span>      - type: custom:mushroom-entity-card</span></span>
<span class="line"><span>        entity: sensor.lian_tong_sheng_yu_liu_liang</span></span>
<span class="line"><span>        name: 剩余流量</span></span>
<span class="line"><span>        layout: vertical</span></span>
<span class="line"><span>        icon: mdi:clipboard-flow</span></span>
<span class="line"><span>      - type: custom:mushroom-entity-card</span></span>
<span class="line"><span>        entity: sensor.lian_tong_sheng_yu_yu_yin</span></span>
<span class="line"><span>        name: 剩余语音</span></span>
<span class="line"><span>        layout: vertical</span></span>
<span class="line"><span>        icon: mdi:account-tie-voice</span></span>
<span class="line"><span>        icon_color: purple</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://www.hasstatic.com/image/filetype/unknown.gif" alt="" loading="lazy"> <a href="https://bbs.hassbian.com/forum.php?mod=attachment&amp;aid=NDYyNzN8YjEzMDI4YmZ8MTY5NDcwMjI2NHw1NzI4M3wyMDA0MA%3D%3D" target="_blank" rel="noopener noreferrer">获取联通余量.json</a> <em>(23.37 KB, 下载次数: 101)</em></p>`,27)]))}const d=e(i,[["render",r]]),c=JSON.parse(`{"path":"/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/Node-red/%E3%80%90node-red%E9%95%BF%E6%9C%9F%E7%A8%B3%E5%AE%9A%E3%80%91%E8%81%94%E9%80%9A%E8%AF%9D%E8%B4%B9%E4%BD%99%E9%A2%9D%E3%80%81%E8%AF%AD%E9%9F%B3%E7%AD%89%E4%BD%99%E9%87%8F%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%85%A5HA.html","title":"【node-red长期稳定】联通话费余额、语音等余量数据接入HA","lang":"zh-CN","frontmatter":{"title":"【node-red长期稳定】联通话费余额、语音等余量数据接入HA","icon":"brands:node","category":["经验总结"],"tag":["IT总结","Node-Red"],"date":"2022-12-10T00:00:00.000Z","order":3,"description":"【node-red长期稳定】联通话费余额、语音等余量数据接入HA 概要 此前我自己也有通过NR抓包过联通余量数据，但是发现token过期很快，然后也看到了下面的帖子，实现方式和我NR的方式差不多。补充：联通话费余额、语音、流量和积分数据接入 ... 【node-red长期稳定】联通话费余额、语音等余量数据接入HA ,『瀚思彼岸』» 智能家居技术论坛 本...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"【node-red长期稳定】联通话费余额、语音等余量数据接入HA\\",\\"image\\":[\\"https://attachment.hasstatic.com/forum/202303/14/143425pkn9ub5rnr6ruhn5.jpg =400x\\",\\"https://attachment.hasstatic.com/forum/202303/14/143251g3k35d37k3e5qkqd.png =400x\\",\\"https://attachment.hasstatic.com/forum/202303/14/143251wdjizqwr41iqb33u.jpg =400x\\",\\"https://attachment.hasstatic.com/forum/202304/06/173428d10gk00d1kzag6sz.png\\",\\"https://attachment.hasstatic.com/forum/202303/14/143622ccgt744y4ctd9u27.png\\",\\"https://www.hasstatic.com/image/filetype/unknown.gif\\"],\\"datePublished\\":\\"2022-12-10T00:00:00.000Z\\",\\"dateModified\\":\\"2025-01-26T06:29:33.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Arthur\\",\\"url\\":\\"https://blog.4a1801.life\\"}]}"],["meta",{"property":"og:url","content":"https://blog.4a1801.life/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/Node-red/%E3%80%90node-red%E9%95%BF%E6%9C%9F%E7%A8%B3%E5%AE%9A%E3%80%91%E8%81%94%E9%80%9A%E8%AF%9D%E8%B4%B9%E4%BD%99%E9%A2%9D%E3%80%81%E8%AF%AD%E9%9F%B3%E7%AD%89%E4%BD%99%E9%87%8F%E6%95%B0%E6%8D%AE%E6%8E%A5%E5%85%A5HA.html"}],["meta",{"property":"og:site_name","content":"Family's Life"}],["meta",{"property":"og:title","content":"【node-red长期稳定】联通话费余额、语音等余量数据接入HA"}],["meta",{"property":"og:description","content":"【node-red长期稳定】联通话费余额、语音等余量数据接入HA 概要 此前我自己也有通过NR抓包过联通余量数据，但是发现token过期很快，然后也看到了下面的帖子，实现方式和我NR的方式差不多。补充：联通话费余额、语音、流量和积分数据接入 ... 【node-red长期稳定】联通话费余额、语音等余量数据接入HA ,『瀚思彼岸』» 智能家居技术论坛 本..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://attachment.hasstatic.com/forum/202303/14/143425pkn9ub5rnr6ruhn5.jpg =400x"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-01-26T06:29:33.000Z"}],["meta",{"property":"article:tag","content":"Node-Red"}],["meta",{"property":"article:tag","content":"IT总结"}],["meta",{"property":"article:published_time","content":"2022-12-10T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-01-26T06:29:33.000Z"}]]},"git":{"createdTime":1694703271000,"updatedTime":1737872973000,"contributors":[{"name":"arthurfsy2","username":"arthurfsy2","email":"fsyflh@gmail.com","commits":7,"url":"https://github.com/arthurfsy2"}]},"readingTime":{"minutes":3.21,"words":964},"filePathRelative":"经验总结/IT总结/Node-red/【node-red长期稳定】联通话费余额、语音等余量数据接入HA.md","localizedDate":"2022年12月10日","excerpt":"<p><a href=\\"https://bbs.hassbian.com/thread-20040-1-1.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">【node-red长期稳定】联通话费余额、语音等余量数据接入HA </a></p>\\n<blockquote>\\n<h2>概要</h2>\\n<p>此前我自己也有通过NR抓包过联通余量数据，但是发现token过期很快，然后也看到了下面的帖子，实现方式和我NR的方式差不多。补充：联通话费余额、语音、流量和积分数据接入 ... 【node-red长期稳定】联通话费余额、语音等余量数据接入HA ,『瀚思彼岸』» 智能家居技术论坛</p>\\n</blockquote>","autoDesc":true}`);export{d as comp,c as data};
