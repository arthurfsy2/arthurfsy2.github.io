import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{ah as a,aj as o,ai as e}from"./app-BaUHGOxV.js";const r={};function n(s,i){return e(),a("div",null,i[0]||(i[0]=[o(`<p><a href="https://github.com/arthurfsy2/xiaomi_yu7_bark_notify" target="_blank" rel="noopener noreferrer">一个可以自动获取小米 YU7 交付进度，通过 Bark 通知给用户的脚本。</a></p><blockquote><p>支持 Github Action / 青龙面板 / Node-RED 设置定时查询<br> 根据预计交付周数转换为预计提车日期<br> 集成无忧服务包状态提示</p></blockquote><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_succeed.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><blockquote><p>本脚本采用 Cookie 的方式进行获取数据，可能存在 Cookie 过期的情况，需要手动更新</p></blockquote><blockquote><p>青龙面板的定时可能更准确一些</p></blockquote><h2 id="github-action" tabindex="-1"><a class="header-anchor" href="#github-action"><span>Github Action</span></a></h2><p>如果你想通过 Github Action 来实现定时获取数据，可进行以下步骤</p><ol><li>fork 本项目到你自己的仓库，然后修改 fork 仓库内的 <code>.github/workflows/run_notify_sync.yml</code>文件，以下内容改为你自己的 github 信息。</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>env:</span></span>
<span class="line"><span>  GITHUB_NAME: arthurfsy2 （修改成你的github名称）</span></span>
<span class="line"><span>  GITHUB_EMAIL: fsyflh@gmail.com （修改为你的github账号邮箱）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>默认执行时间是每5分钟会自动执行脚本。

如需修改时间，可修改以下代码的\`cron\`
</code></pre><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>on:</span></span>
<span class="line"><span>  workflow_dispatch:</span></span>
<span class="line"><span>  schedule:</span></span>
<span class="line"><span>    - cron: &#39;*/5 * * * *&#39;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="2"><li><p>为 GitHub Actions 添加代码提交权限 访问 repo Settings &gt; Actions &gt; General 页面，找到 Workflow permissions 的设置项，将选项配置为 Read and write permissions。</p><blockquote><p>如果不设置允许的话，会导致 workflows 无法更新配置文件</p></blockquote></li><li><p>在 repo Settings &gt; Security &gt; Secrets &gt; secrets and variables &gt; Actions &gt; New repository secret &gt; 增加:<br> ORDERID、USERID、COOKIE、CARSHOPCOOKIE、DEVICE_TOKEN 这 5 个变量</p><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/添加变量.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>ORDERID、USERID、COOKIE 获取方法：<br> 使用<a href="https://reqable.com/zh-CN" target="_blank" rel="noopener noreferrer">Reqable</a>等抓包工具，抓取 <code>小米汽车微信小程序</code><br> 查看：<code>https://api.retail.xiaomiev.com/mtop/car-order/order/detail</code></p></li></ol><ul><li>ORDERID、USERID 的获取：<br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/1.png" alt="img" loading="lazy"></li><li>COOKIE 的获取</li></ul><blockquote><p>注意：COOKIE 变量在粘贴到 github action 时，首尾要添加 <code>&quot;</code>符号</p></blockquote><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/2.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol start="5"><li><p>CARSHOPCOOKIE 获取方法：</p><p>使用<a href="https://reqable.com/zh-CN" target="_blank" rel="noopener noreferrer">Reqable</a>等抓包工具，抓取 <code>小米汽车App</code><br> 查看：<code>https://carshop-api.retail.xiaomiev.com/mtop/carlife/product/info</code></p><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/4.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>DEVICE_TOKEN 的获取<br> IOS 下载 <code>Bark</code>--&gt;服务器--&gt;复制 device_token<br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/3.png" alt="img" loading="lazy"></p></li></ol><blockquote><p>在 device_token 正确的情况下，运行 action 后，如果 ORDERID、USERID、COOKIE 任意一个参数存在问题，会发送错误提醒</p></blockquote><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_error.jpg" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="青龙面板" tabindex="-1"><a class="header-anchor" href="#青龙面板"><span>青龙面板</span></a></h2><p>如果你是和我一样，是一个略懂青龙面板的“脚本小子”，也可以通过以下来设置定时任务来执行脚本</p><ol><li>安装 Python 依赖：requests、toml<br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-1.png" alt="img" loading="lazy"></li><li>复制文件</li></ol><ul><li>需复制文件：yu7_notify.py、configBAK.toml（需手动改名为 config.toml）</li><li>修改 config.toml 当中的 orderId、userId、Cookie、device_token（取值来源可参考上文）<br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-2.1.png" alt="img" loading="lazy"><br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-2.2.png" alt="img" loading="lazy"></li></ul><blockquote><p>如果是 docker 部署的青龙面板，可以将上述 2 个文件复制粘贴到宿主机对应的目录</p></blockquote><ol start="3"><li>调试脚本（可选）<br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-3.1.png" alt="img" loading="lazy"><br><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-3.2.png" alt="img" loading="lazy"></li></ol><blockquote><p>如果依赖安装正常、账号参数正确，则会输出对应的日志提示</p></blockquote><ol start="4"><li>设置定时任务</li></ol><ul><li>名称：<code>yu7_notify</code>（可修改）</li><li>命令/脚本：<code>python /ql/data/scripts/yu7_notify/yu7_notify.py</code></li><li>定时规则：<code>*/5 * * * *</code> (默认每 5 分钟执行一次)</li></ul><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-4.1.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-4.2.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><h2 id="node-red-home-assistant" tabindex="-1"><a class="header-anchor" href="#node-red-home-assistant"><span>Node-RED + home-assistant</span></a></h2><p>如果你恰好是一个智能家居爱好者，可以通过 Node-RED 来获取信息，并在 home-assitant 当中展示</p><ol><li>前置步骤：</li></ol><ul><li>你的 ha 和 NR 已经完成连接</li><li>已在 NR 当中安装 <code>Node-RED-contrib-http-request</code>这个节点</li><li>已将对应的 HA server 更换为你自己的配置</li></ul><ol start="2"><li>NR 导入文件 <code>yu7_notify.json</code></li><li>复制文件</li></ol><ul><li>需复制 <code>Node-RED</code>下的 2 个文件：config.json、yu7_notify.json</li><li>修改 config.json 当中的 orderId、userId、Cookie、device_token（取值来源可参考上文）</li></ul><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-3.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><blockquote><p>如果是 docker 部署的 Node-RED，可以将上述 2 个文件复制粘贴到宿主机对应的目录</p></blockquote><ol start="4"><li>修改执行周期</li></ol><p>默认是每 5 分钟执行一次，可手动修改】</p><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-4.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure><ol start="5"><li>HA 实体</li></ol><p>当运行成功一次后，会在 HA 当中新增实体，之后可以尽情发挥你的想象力了！</p><figure><img src="https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-5.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure>`,43)]))}const g=t(r,[["render",n]]),m=JSON.parse(`{"path":"/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/python/xiaomi_yu7_bark_notify.html","title":"小米 YU7 交付进度自动通知","lang":"zh-CN","frontmatter":{"icon":"brands:python","title":"小米 YU7 交付进度自动通知","date":"2025-06-30T00:00:00.000Z","category":["经验总结"],"tag":["IT总结"],"order":2,"description":"一个可以自动获取小米 YU7 交付进度，通过 Bark 通知给用户的脚本。 支持 Github Action / 青龙面板 / Node-RED 设置定时查询 根据预计交付周数转换为预计提车日期 集成无忧服务包状态提示 imgimg 本脚本采用 Cookie 的方式进行获取数据，可能存在 Cookie 过期的情况，需要手动更新 青龙面板的定时可能更准确...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"小米 YU7 交付进度自动通知\\",\\"image\\":[\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_succeed.jpg\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/添加变量.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/1.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/2.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/4.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/3.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_error.jpg\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-1.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-2.1.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-2.2.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-3.1.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-3.2.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-4.1.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/ql-4.2.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-3.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-4.png\\",\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/nr-5.png\\"],\\"datePublished\\":\\"2025-06-30T00:00:00.000Z\\",\\"dateModified\\":\\"2025-07-10T09:26:08.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Arthur\\",\\"url\\":\\"https://blog.4a1801.life\\"}]}"],["meta",{"property":"og:url","content":"https://blog.4a1801.life/%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/IT%E6%80%BB%E7%BB%93/python/xiaomi_yu7_bark_notify.html"}],["meta",{"property":"og:site_name","content":"Family's Life"}],["meta",{"property":"og:title","content":"小米 YU7 交付进度自动通知"}],["meta",{"property":"og:description","content":"一个可以自动获取小米 YU7 交付进度，通过 Bark 通知给用户的脚本。 支持 Github Action / 青龙面板 / Node-RED 设置定时查询 根据预计交付周数转换为预计提车日期 集成无忧服务包状态提示 imgimg 本脚本采用 Cookie 的方式进行获取数据，可能存在 Cookie 过期的情况，需要手动更新 青龙面板的定时可能更准确..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_succeed.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-07-10T09:26:08.000Z"}],["meta",{"property":"article:tag","content":"IT总结"}],["meta",{"property":"article:published_time","content":"2025-06-30T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-07-10T09:26:08.000Z"}]]},"git":{"createdTime":1752139568000,"updatedTime":1752139568000,"contributors":[{"name":"arthurfsy2","username":"arthurfsy2","email":"129527972+arthurfsy2@users.noreply.github.com","commits":1,"url":"https://github.com/arthurfsy2"}]},"readingTime":{"minutes":3.25,"words":974},"filePathRelative":"经验总结/IT总结/python/xiaomi_yu7_bark_notify.md","excerpt":"<p><a href=\\"https://github.com/arthurfsy2/xiaomi_yu7_bark_notify\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">一个可以自动获取小米 YU7 交付进度，通过 Bark 通知给用户的脚本。</a></p>\\n<blockquote>\\n<p>支持 Github Action / 青龙面板 / Node-RED 设置定时查询<br>\\n根据预计交付周数转换为预计提车日期<br>\\n集成无忧服务包状态提示</p>\\n</blockquote>\\n<figure><img src=\\"https://raw.githubusercontent.com/arthurfsy2/xiaomi_yu7_bark_notify/main/img/para_succeed.jpg\\" alt=\\"img\\" tabindex=\\"0\\" loading=\\"lazy\\"><figcaption>img</figcaption></figure>","autoDesc":true}`);export{g as comp,m as data};
